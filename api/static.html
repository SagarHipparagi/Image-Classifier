<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Classifier - AI Recognition</title>
    <link rel="icon" type="image/png" href="/api/favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        // Prevent FOUC (Flash of Unstyled Content)
        (function () {
            try {
                const localTheme = localStorage.getItem('theme');
                const sysTheme = window.matchMedia('(prefers-color-scheme: dark)').matches;
                if (localTheme === 'dark' || (!localTheme && sysTheme)) {
                    document.documentElement.setAttribute('data-theme', 'dark');
                } else {
                    document.documentElement.setAttribute('data-theme', 'light');
                }
            } catch (e) { }
        })();
    </script>
    <style>
        :root {
            /* Light Theme (Default) */
            --bg-primary: #ffffff;
            --bg-secondary: #f9fafb;
            --bg-card: #ffffff;
            --bg-glass: rgba(255, 255, 255, 0.9);
            --text-primary: #111827;
            --text-secondary: #4b5563;
            --text-muted: #9ca3af;
            --border: #e5e7eb;
            --accent: #2563eb;
            --accent-hover: #1d4ed8;
            --accent-light: #eff6ff;
            --success: #10b981;
            --error: #ef4444;
            --error-bg: #fef2f2;
            --error-border: #fecaca;
            --error-text: #991b1b;
        }

        [data-theme="dark"] {
            /* Dark Theme */
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-card: #1e293b;
            --bg-glass: rgba(15, 23, 42, 0.9);
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border: #334155;
            --accent: #3b82f6;
            --accent-hover: #60a5fa;
            --accent-light: rgba(59, 130, 246, 0.1);
            --error-bg: #451a1a;
            --error-border: #7f1d1d;
            --error-text: #fca5a5;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: background-color 0.3s, color 0.3s;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 16px;
        }

        .navbar .container {
            max-width: none;
            width: 100%;
            padding: 0 32px;
        }

        .content {
            max-width: 900px;
            margin: 0 auto;
        }

        .navbar {
            position: sticky;
            top: 0;
            background: var(--bg-glass);
            border-bottom: 1px solid var(--border);
            backdrop-filter: blur(10px);
            z-index: 100;
            transition: background-color 0.3s, border-color 0.3s;
            width: 100%;
        }

        .navbar-inner {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 64px;
            width: 100%;
            padding: 0 32px;
        }

        .brand {
            font-size: 18px;
            font-weight: 700;
            text-decoration: none;
            color: var(--text-primary);
        }

        /* Theme Toggle */
        .theme-toggle {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-primary);
            padding: 8px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
            position: absolute;
            right: 32px;
        }

        .theme-toggle:hover {
            background: var(--bg-secondary);
        }

        .theme-toggle svg {
            width: 20px;
            height: 20px;
            fill: none;
            stroke: currentColor;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        [data-theme="dark"] .icon-moon {
            display: none;
        }

        [data-theme="light"] .icon-sun {
            display: none;
        }

        .hero {
            padding: 64px 16px;
            text-align: center;
        }

        .hero-title {
            font-size: 52px;
            font-weight: 700;
            letter-spacing: -1px;
            line-height: 1.2;
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        .hero-subtitle {
            font-size: 18px;
            color: var(--text-secondary);
            margin-bottom: 32px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            font-weight: 700;
        }

        .main {
            padding: 32px 16px;
        }

        .upload-zone {
            max-width: 700px;
            margin: 0 auto 64px;
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 48px;
            text-align: center;
            cursor: pointer;
            transition: all 200ms;
            background: var(--bg-secondary);
        }

        .upload-zone:hover {
            border-color: var(--accent);
            background: var(--accent-light);
        }

        .upload-zone.dragging {
            border-color: var(--accent);
            background: var(--accent-light);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.8;
        }

        .text {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .subtext {
            font-size: 14px;
            color: var(--text-muted);
        }

        #imageInput {
            display: none;
        }

        #preview {
            display: none;
            max-width: 700px;
            margin: 0 auto;
        }

        .img-wrapper {
            margin-bottom: 24px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            background: var(--bg-card);
        }

        #previewImage {
            width: 100%;
            height: auto;
            max-height: 400px;
            object-fit: contain;
            display: block;
        }

        .buttons {
            display: flex;
            gap: 16px;
            margin-top: 24px;
        }

        button {
            flex: 1;
            padding: 16px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 150ms;
            font-family: Inter, sans-serif;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--accent-hover);
            transform: translateY(-1px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--border);
        }

        #loading {
            display: none;
            text-align: center;
            padding: 48px 16px;
            max-width: 700px;
            margin: 0 auto;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .load-text {
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
        }

        #results {
            display: none;
            max-width: 700px;
            margin: 0 auto 64px;
        }

        .results-header {
            margin-bottom: 24px;
        }

        .results-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .results-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .results-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .result-item {
            background: var(--bg-card);
            border: 1px solid var(--border);
            padding: 24px;
            border-radius: 8px;
            transition: all 200ms;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-8px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-item:hover {
            border-color: var(--accent);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .rank {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: var(--accent);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            font-size: 12px;
            font-weight: 700;
            margin-right: 16px;
        }

        .label {
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            color: var(--text-primary);
        }

        .confidence {
            color: var(--text-secondary);
            font-size: 14px;
            display: flex;
            align-items: center;
            margin-left: 36px;
        }

        .bar {
            display: inline-block;
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            width: 100px;
            margin-left: 8px;
            overflow: hidden;
        }

        .fill {
            height: 100%;
            background: var(--success);
            border-radius: 2px;
            transition: width 0.6s ease-out;
        }

        #error {
            display: none;
            max-width: 700px;
            margin: 16px auto;
        }

        .error-msg {
            background: var(--error-bg);
            border: 1px solid var(--error-border);
            border-left: 4px solid var(--error);
            color: var(--error-text);
            padding: 24px;
            border-radius: 8px;
            font-size: 14px;
            animation: slideIn 0.3s ease-out;
        }

        #cameraModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }

        .camera-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-card);
            border-radius: 12px;
            padding: 24px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        #video {
            width: 100%;
            border-radius: 8px;
            margin-bottom: 16px;
            display: block;
            background: #000;
        }

        #canvas {
            display: none;
        }

        .camera-buttons {
            display: flex;
            gap: 12px;
        }

        .camera-buttons button {
            flex: 1;
            padding: 12px;
        }

        @media (max-width: 768px) {
            .hero-title {
                font-size: 36px;
            }

            .buttons {
                flex-direction: column;
            }

            button {
                width: 100%;
            }

            .label {
                flex-direction: column;
                align-items: flex-start;
            }

            .confidence {
                margin-left: 0;
                margin-top: 8px;
            }
        }
    </style>
</head>

<nav class="navbar">
    <div class="navbar-inner">
        <a href="#" class="brand">Classifier</a>
        <button class="theme-toggle" id="themeBtn" aria-label="Toggle Dark Mode">
            <!-- Sun Icon (for Light Mode) -->
            <svg class="icon-sun" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
            <!-- Moon Icon (for Dark Mode) -->
            <svg class="icon-moon" viewBox="0 0 24 24">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
        </button>
    </div>
</nav>
<section class="hero">
    <div class="content">
        <h1 class="hero-title">Intelligent Image Recognition</h1>
        <p class="hero-subtitle">Upload an image and let AI instantly classify it. Fast, accurate, and designed for
            everyone.</p>
    </div>
</section>
<section class="main">
    <div class="content">
        <div class="upload-zone" id="uploadArea">
            <div class="icon">ðŸ“·</div>
            <div class="text">Click to upload or drag and drop</div>
            <div class="subtext">PNG, JPG, WebP - Up to 25MB</div>
        </div><button class="btn-primary" id="cameraBtn"
            style="max-width: 700px; margin: 0 auto 64px; display: block; width: 100%;">Take Photo with
            Camera</button><input type="file" id="imageInput" accept="image/*">
        <div id="preview">
            <div class="img-wrapper"><img id="previewImage" alt="preview"></div>
            <div class="buttons"><button class="btn-primary" id="classifyBtn">Classify Image</button><button
                    class="btn-secondary" id="clearBtn">Clear</button></div>
        </div>
        <div id="loading">
            <div class="spinner"></div>
            <p class="load-text">Analyzing image...</p>
        </div>
        <div id="results"></div>
        <div id="error"></div>
    </div>
</section>
<div id="cameraModal">
    <div class="camera-container">
        <h2>Take Photo</h2><video id="video" autoplay></video><canvas id="canvas"></canvas>
        <div class="camera-buttons"><button class="btn-primary" id="captureBtn">Capture</button><button
                class="btn-secondary" id="closeCameraBtn">Cancel</button></div>
    </div>
</div>
<script>
    let file = null, stream = null;
    const area = document.getElementById('uploadArea'), inp = document.getElementById('imageInput'), prev = document.getElementById('preview'), img = document.getElementById('previewImage'), cls = document.getElementById('classifyBtn'), clr = document.getElementById('clearBtn'), res = document.getElementById('results'), err = document.getElementById('error'), load = document.getElementById('loading'), camBtn = document.getElementById('cameraBtn'), camModal = document.getElementById('cameraModal'), video = document.getElementById('video'), canvas = document.getElementById('canvas'), capBtn = document.getElementById('captureBtn'), closeBtn = document.getElementById('closeCameraBtn');
    area.addEventListener('click', e => { e.preventDefault(); e.stopPropagation(); inp.click(); });
    inp.addEventListener('change', e => { if (e.target.files[0]) handleFileSelect(e.target.files[0]); });
    area.addEventListener('dragover', e => { e.preventDefault(); e.stopPropagation(); area.classList.add('dragging'); });
    area.addEventListener('dragleave', e => { e.preventDefault(); e.stopPropagation(); area.classList.remove('dragging'); });
    area.addEventListener('drop', e => { e.preventDefault(); e.stopPropagation(); area.classList.remove('dragging'); if (e.dataTransfer.files[0]) handleFileSelect(e.dataTransfer.files[0]); });
    camBtn.addEventListener('click', () => { navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } }).then(s => { stream = s; video.srcObject = s; camModal.style.display = 'flex' }).catch(e => { show_err('Camera access denied. Please allow camera permissions.') }) });
    capBtn.addEventListener('click', () => { const ctx = canvas.getContext('2d'); canvas.width = video.videoWidth; canvas.height = video.videoHeight; ctx.drawImage(video, 0, 0); canvas.toBlob(blob => { if (blob) { file = blob; const r = new FileReader(); r.onload = e => { img.src = e.target.result; prev.style.display = 'block'; area.style.display = 'none'; res.style.display = 'none'; err.style.display = 'none'; camModal.style.display = 'none'; if (stream) stream.getTracks().forEach(t => t.stop()) }; r.readAsDataURL(blob) } }) });
    closeBtn.addEventListener('click', () => { camModal.style.display = 'none'; if (stream) stream.getTracks().forEach(t => t.stop()) });
    function handleFileSelect(f) { if (!f || !f.type.startsWith('image/')) return show_err('Valid image required'); file = f; const r = new FileReader(); r.onload = e => { img.src = e.target.result; prev.style.display = 'block'; area.style.display = 'none'; res.style.display = 'none'; err.style.display = 'none' }; r.readAsDataURL(f); }
    cls.addEventListener('click', async () => { if (!file) return; const d = new FormData(); d.append('image', file); load.style.display = 'block'; cls.disabled = true; res.style.display = 'none'; err.style.display = 'none'; try { const url = '/api/classify'; const r = await fetch(url, { method: 'POST', body: d }); if (!r.ok) return show_err('Server error: ' + r.status); let j; try { j = await r.json(); } catch (e) { return show_err('Invalid response format'); } if (!j.predictions || !Array.isArray(j.predictions)) return show_err('Invalid predictions format'); show_res(j.predictions); } catch (e) { show_err('Network error: ' + e.message); } finally { load.style.display = 'none'; cls.disabled = false; } });
    clr.addEventListener('click', () => { file = null; inp.value = ''; prev.style.display = 'none'; area.style.display = 'block'; area.classList.remove('dragging'); res.style.display = 'none'; err.style.display = 'none'; });
    function show_res(p) { let h = '<div class="results-header"><div class="results-title">Results</div><div class="results-subtitle">' + p.length + ' predictions</div></div><div class="results-list">'; p.forEach((x, i) => { const c = parseFloat(x.confidence) || 0; h += '<div class="result-item"><div class="label"><span class="rank">' + (i + 1) + '</span><span>' + x.label + '</span></div><div class="confidence">' + x.confidence + '<span class="bar"><span class="fill" style="width:' + c + '%"></span></span></div></div>' }); res.innerHTML = h + '</div>'; res.style.display = 'block'; }
    function show_err(m) { err.innerHTML = '<div class="error-msg">Warning: ' + m + '</div>'; err.style.display = 'block'; }

    // Theme Toggle Logic
    const tBtn = document.getElementById('themeBtn');
    tBtn.addEventListener('click', () => {
        const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
        const newTheme = isDark ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
    });
</script>
</body>

</html>